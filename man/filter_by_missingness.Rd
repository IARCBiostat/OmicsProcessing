% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/filter_by_missingness.R
\name{filter_by_missingness}
\alias{filter_by_missingness}
\title{Filter a data frame by missingness in selected rows and columns}
\usage{
filter_by_missingness(
  df,
  row_thresh = 0.5,
  col_thresh = 0.5,
  target_cols = NULL,
  is_qc = NULL,
  filter_order = c("simultaneous", "col_then_row", "row_then_col")
)
}
\arguments{
\item{df}{A data frame to filter.}

\item{row_thresh}{Numeric value between 0 and 1. Maximum allowed proportion
of missing values per row (excluding QC rows). Default is 0.5.}

\item{col_thresh}{Numeric value between 0 and 1. Maximum allowed proportion
of missing values per column (calculated across non-QC rows). Default is 0.5.}

\item{target_cols}{Either a character vector of column names or a single
string interpreted as a regular expression. Used to select columns for
missingness filtering. If \code{NULL}, all columns are used.}

\item{is_qc}{Optional logical vector indicating QC rows. If \code{NULL},
all rows are treated as analytical samples (i.e., no QC rows).}

\item{filter_order}{Character string indicating the filtering mode.
One of \code{"simultaneous"} (default), \code{"col_then_row"}, or
\code{"row_then_col"}.}
}
\value{
A filtered data frame with:
\itemize{
\item Retained columns: all non-target columns, plus only target columns
that pass the \code{col_thresh}.
\item Retained rows: all QC rows, plus non-QC rows that pass the
\code{row_thresh} based on selected columns.
}
}
\description{
This function filters rows and columns from a data frame based on missing
value thresholds. Missingness is calculated using a selected subset of
columns, defined either by a regular expression or an explicit list of
column names. QC samples can optionally be excluded from the filtering
process and are always retained in the output.
}
\details{
The function works on any data frame, including those that do not contain
QC samples (set \code{is_qc = NULL} or leave it empty), and can also be
applied to all columns (by setting \code{target_cols = NULL} or leaving
it empty).

QC samples (identified using the \code{is_qc} logical vector) are excluded
from all missingness calculations, but retained in the output. This ensures
that filtering is based solely on analytical samples, while preserving QC
rows for downstream inspection or diagnostics.

Users can optionally control the order in which row and column filtering is
applied using the \code{filter_order} argument. The default is
\code{"simultaneous"}, which performs both row and column filtering at once.
Sequential filtering modes (\code{"col_then_row"} or \code{"row_then_col"})
may be useful for fine-tuning missingness cleanup in certain datasets.
}
\examples{
df <- data.frame(
  A = c(1, NA, 3, NA),
  B = c(1, 2, NA, NA),
  C = 1:4,
  qc = c(FALSE, TRUE, FALSE, TRUE)
)

# 1. Use explicit column list and QC exclusion
filter_by_missingness(df, target_cols = c("A", "B"), is_qc = df$qc)

# 2. Use regex to select columns
filter_by_missingness(df, target_cols = "^A|B$", is_qc = df$qc)

# 3. Apply to all columns and assume all rows are non-QC
filter_by_missingness(df)

# 4. Remove columns first, then rows
filter_by_missingness(df, filter_order = "col_then_row")

# 5. Remove rows first, then columns
filter_by_missingness(df, filter_order = "row_then_col")

}
