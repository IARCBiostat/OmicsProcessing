% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/remove_outliers.R
\name{remove_outliers}
\alias{remove_outliers}
\title{Remove Outliers from a Data Frame}
\usage{
remove_outliers(
  df,
  target_cols = NULL,
  is_qc = NULL,
  method = c("pca-lof-overall"),
  impute_method = c(NULL, "half-min-value"),
  restore_missing_values = TRUE,
  return_ggplots = FALSE
)
}
\arguments{
\item{df}{A data frame with samples in rows and features in columns.}

\item{target_cols}{Either a character vector of column names to include
in the analysis, or a single regular expression string to match
column names. If \code{NULL}, all columns are used.}

\item{is_qc}{A logical vector indicating which rows are QC samples. If
\code{NULL}, all samples are treated as non-QC.}

\item{method}{Outlier detection method. Currently only
\code{"pca-lof-overall"} is supported.}

\item{impute_method}{Optional method for imputing missing values prior to
outlier detection. One of \code{NULL} (no imputation) or
\code{"half-min-value"}.}

\item{restore_missing_values}{Logical; if \code{TRUE}, restores original \code{NA}
values to the filtered data.}

\item{return_ggplots}{Logical; if \code{TRUE}, returns a ggplot of the
outlier detection.}
}
\value{
A list with the following elements:
\describe{
\item{df_filtered}{Data frame with outliers removed from non-QC samples,
QC rows retained, and original row order preserved
(excluding removed outliers).}
\item{plot_samples_outlier}{A \code{ggplot2} object visualising outlier detection.}
\item{excluded_ids}{Character vector of sample IDs (rownames) identified
and removed as outliers.}
}
}
\description{
Detects and removes outliers from the non-QC portion of a data frame
using a specified method (currently supports \code{"pca-lof-overall"}).
Users can specify which columns to analyse using a regular expression
or a character vector of column names. Optional imputation is supported
for missing values, and original \code{NA}s can be restored after filtering.
}
\examples{
\dontrun{
result <- remove_outliers(
    df = my_data,
    target_cols = "^metab_",
    is_qc = my_data$SampleType == "QC",
    method = "pca-lof-overall",
    impute_method = "half-min-value"
)

head(result$df_filtered)
print(result$plot_samples_outlier)
result$excluded_ids
}
}
