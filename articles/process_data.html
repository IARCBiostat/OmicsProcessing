<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Semi-automated pipeline with process_data() • OmicsProcessing</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Semi-automated pipeline with process_data()">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">OmicsProcessing</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/data-filtering.html">Data filtering with filter_by_missingness()</a></li>
    <li><a class="dropdown-item" href="../articles/developer-guidelines.html">Developers &amp; Contributors</a></li>
    <li><a class="dropdown-item" href="../articles/feature-clustering.html">Feature clustering by retention time</a></li>
    <li><a class="dropdown-item" href="../articles/hybrid-imputation.html">Hybrid imputation with RF + LCMD</a></li>
    <li><a class="dropdown-item" href="../articles/log-transformation.html">Log transformation with log1p()</a></li>
    <li><a class="dropdown-item" href="../articles/outlier-removal.html">Outlier removal with remove_outliers()</a></li>
    <li><a class="dropdown-item" href="../articles/process_data.html">Semi-automated pipeline with process_data()</a></li>
    <li><a class="dropdown-item" href="../articles/serrf-normalisation.html">Batch correction using SERRF</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Semi-automated pipeline with process_data()</h1>
            
      

      <div class="d-none name"><code>process_data.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="the-process_data-documentation">The <code>process_data()</code> documentation<a class="anchor" aria-label="anchor" href="#the-process_data-documentation"></a>
</h2>
<p>This package provides a general function <code><a href="../reference/process_data.html">process_data()</a></code>
for the pre-analysis processing of omics data (e.g.,
metabolomics/proteomics). All processing steps are optional and can be
tailored to the users specific requirements. This function performs the
following processing steps (in order):</p>
<ol style="list-style-type: decimal">
<li>Excludes features with extreme missingness based on a specified
threshold</li>
<li>Excludes samples with extreme missingness based on a specified
threshold</li>
<li>Imputes missing values using various methods</li>
<li>Transforms the data using specified methods</li>
<li>Excludes outlying samples using PCA and LOF</li>
<li>Handles case-control data to ensure matched samples are treated
appropriately</li>
<li>Corrects for plate effects using specified random and fixed
effects</li>
<li>Centers and scales the data</li>
</ol>
<p>Requires 3 data frames:</p>
<ol style="list-style-type: decimal">
<li>feature data
<ul>
<li>column 1 = sample IDs; column 2-N = features</li>
<li>example data: <code>data("data_features")</code>
</li>
</ul>
</li>
<li>feature meta-data
<ul>
<li>column 1 = feature column names; column 2-N = feature information
(e.g., % missing, LOD)</li>
<li>example data: <code>data("data_meta_features")</code>
</li>
</ul>
</li>
<li>sample meta-data
<ul>
<li>column 1 = sample IDs; column 2-N = sample information (e.g., batch,
age, sex)</li>
<li>example data: <code>data("data_meta_samples")</code>
</li>
</ul>
</li>
</ol>
<p>Returns a list of:</p>
<ol style="list-style-type: decimal">
<li>
<code>df_features</code>: processed feature dataframe</li>
<li>
<code>df_meta_samples</code>: filtered sample meta-data</li>
<li>
<code>df_meta_features</code>: filteres feature meta-data</li>
<li>
<code>plot_samples_outlier</code>: figure of PCA/LOF analysis</li>
<li>
<code>id_exclusions</code>: a list of IDs:
<ul>
<li>
<code>id_features_exclude</code>: feature IDs excluded for extreme
sample missingness</li>
<li>
<code>id_samples_exclude</code>: sample IDs excluded for extreme
sample missingness</li>
<li>
<code>id_samples_outlier</code>: sample IDs excluded in PCA/LOF
analysis</li>
<li>
<code>id_samples_casecontrol</code>: sample IDs excluded because a
matched case-control was excluded</li>
</ul>
</li>
</ol>
</div>
<div class="section level2">
<h2 id="how">How<a class="anchor" aria-label="anchor" href="#how"></a>
</h2>
<p>All arguments are independent and examples are given below. Each
function (e.g., <code><a href="../reference/impute_data.html">impute_data()</a></code>) can be used independently of
<code><a href="../reference/process_data.html">process_data()</a></code></p>
<div class="section level3">
<h3 id="sample-and-feature-exclusions-for-10-missingness">Sample and feature exclusions for &gt;10% missingness<a class="anchor" aria-label="anchor" href="#sample-and-feature-exclusions-for-10-missingness"></a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_processed</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/process_data.html">process_data</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data_features</span>, </span>
<span>  col_samples <span class="op">=</span> <span class="st">"ID_sample"</span>, </span>
<span>  exclusion_extreme_feature <span class="op">=</span> <span class="cn">TRUE</span>, missing_pct_feature <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  exclusion_extreme_sample <span class="op">=</span> <span class="cn">TRUE</span>, missing_pct_sample <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Exclusion features: excluding features with more than 10% missingness </span></span>
<span><span class="co">## Exclusion features: excluded 44 feature(s) </span></span>
<span><span class="co"># Exclusion samples: excluding samples with more than 10% missingness </span></span>
<span><span class="co">## Exclusion samples: excluded 15 sample(s) </span></span>
<span><span class="co">### total feature(s) excluded = 44 </span></span>
<span><span class="co">### total sample(s) excluded = 15 </span></span>
<span><span class="co"># returning a list of data and exclusion IDs</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="imputation-of-missing-feature-data">Imputation of missing feature data<a class="anchor" aria-label="anchor" href="#imputation-of-missing-feature-data"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="sc">&gt;</span> data_processed <span class="ot">&lt;-</span> <span class="fu">process_data</span>(</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="sc">+</span>   <span class="at">data =</span> data_features, </span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="sc">+</span>   <span class="at">col_samples =</span> <span class="st">"ID_sample"</span>, </span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="sc">+</span>   <span class="at">imputation =</span> <span class="cn">TRUE</span>, <span class="at">imputation_method =</span> <span class="st">"mean"</span>)</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="do">## Imputation using mean </span></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a><span class="do">### total feature(s) excluded = 0 </span></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a><span class="do">### total sample(s) excluded = 0 </span></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a><span class="co"># returning a list of data and exclusion IDs</span></span></code></pre></div>
<p>If imputing using limit of detection (LOD) or equivalent, you must
provide a feature meta-data file which contains a column with feature
names and a column of LOD or equivalent:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_processed</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/process_data.html">process_data</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data_features</span>, </span>
<span>  data_meta_features <span class="op">=</span> <span class="va">data_meta_features</span>, col_features <span class="op">=</span> <span class="st">"ID_feature"</span>, col_LOD <span class="op">=</span> <span class="st">"LOD"</span>,</span>
<span>  col_samples <span class="op">=</span> <span class="st">"ID_sample"</span>, </span>
<span>  imputation <span class="op">=</span> <span class="cn">TRUE</span>, imputation_method <span class="op">=</span> <span class="st">"LOD"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="transformation-of-feature-data">Transformation of feature data<a class="anchor" aria-label="anchor" href="#transformation-of-feature-data"></a>
</h3>
<p>Ttransformation by all <code>log10</code> methods will also perform
centering and scaling to a mean of 0</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="sc">&gt;</span> data_processed <span class="ot">&lt;-</span> <span class="fu">process_data</span>(</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="sc">+</span>   <span class="at">data =</span> data_features, </span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="sc">+</span>   <span class="at">col_samples =</span> <span class="st">"ID_sample"</span>, </span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="sc">+</span>   <span class="at">transformation =</span> <span class="cn">TRUE</span>, <span class="at">transformation_method =</span> <span class="st">"InvRank"</span>)</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="do">## Transformation using InvRank </span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="do">### total feature(s) excluded = 0 </span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="do">### total sample(s) excluded = 0 </span></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a><span class="co"># returning a list of data and exclusion IDs</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="sample-outlier-exclusions-based-on-pca-and-lof">Sample outlier exclusions based on PCA and LOF<a class="anchor" aria-label="anchor" href="#sample-outlier-exclusions-based-on-pca-and-lof"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="sc">&gt;</span> data_processed <span class="ot">&lt;-</span> <span class="fu">process_data</span>(</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="sc">+</span>   <span class="at">data =</span> data_features, </span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="sc">+</span>   <span class="at">col_samples =</span> <span class="st">"ID_sample"</span>, </span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="sc">+</span>   <span class="at">exclusion_extreme_feature =</span> <span class="cn">TRUE</span>, <span class="at">missing_pct_feature =</span> <span class="fl">0.1</span>,</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="sc">+</span>   <span class="at">exclusion_extreme_sample =</span> <span class="cn">TRUE</span>, <span class="at">missing_pct_sample =</span> <span class="fl">0.1</span>,</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="sc">+</span>   <span class="at">imputation =</span> <span class="cn">TRUE</span>, <span class="at">imputation_method =</span> <span class="st">"mean"</span>,</span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="sc">+</span>   <span class="at">outlier =</span> <span class="cn">TRUE</span>)</span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a><span class="co"># Exclusion features: excluding features with more than 10% missingness </span></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a><span class="do">## Exclusion features: excluded 44 feature(s) </span></span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a><span class="co"># Exclusion samples: excluding samples with more than 10% missingness </span></span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a><span class="do">## Exclusion samples: excluded 15 sample(s) </span></span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a><span class="do">## Imputation using mean </span></span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a><span class="co"># Outlier exclusion using PCA and LOF </span></span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a><span class="do">## Excluded 0 sample(s)</span></span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a><span class="do">## Creating sample outlier plot</span></span>
<span id="cb5-17"><a href="#cb5-17" tabindex="-1"></a><span class="do">### total feature(s) excluded = 44 </span></span>
<span id="cb5-18"><a href="#cb5-18" tabindex="-1"></a><span class="do">### total sample(s) excluded = 15 </span></span>
<span id="cb5-19"><a href="#cb5-19" tabindex="-1"></a><span class="co"># returning a list of data, outlier plot, and exclusion IDs</span></span></code></pre></div>
<p>The outlier function creates a PCA plot where samples are coloured by
their LOF. As an example, we can introduce an outlier sample by
multiplying all feature values for ID_10 by 1.5:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="sc">&gt;</span> data_features_outlier <span class="ot">&lt;-</span> data_features <span class="sc">%&gt;%</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="sc">+</span>   dplyr<span class="sc">::</span><span class="fu">mutate</span>(dplyr<span class="sc">::</span><span class="fu">across</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">101</span>, <span class="sc">~</span> <span class="fu">ifelse</span>(dplyr<span class="sc">::</span><span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">10</span>, . <span class="sc">*</span> <span class="fl">1.5</span>, .)))</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="sc">&gt;</span> data_processed <span class="ot">&lt;-</span> <span class="fu">process_data</span>(</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="sc">+</span>   <span class="at">data =</span> data_features_outlier,</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a><span class="sc">+</span>   <span class="at">col_samples =</span> <span class="st">"ID_sample"</span>, </span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a><span class="sc">+</span>   <span class="at">exclusion_extreme_feature =</span> <span class="cn">TRUE</span>, <span class="at">missing_pct_feature =</span> <span class="fl">0.1</span>,</span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a><span class="sc">+</span>   <span class="at">exclusion_extreme_sample =</span> <span class="cn">TRUE</span>, <span class="at">missing_pct_sample =</span> <span class="fl">0.1</span>,</span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a><span class="sc">+</span>   <span class="at">imputation =</span> <span class="cn">TRUE</span>, <span class="at">imputation_method =</span> <span class="st">"mean"</span>,</span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a><span class="sc">+</span>   <span class="at">outlier =</span> <span class="cn">TRUE</span>)</span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a></span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a><span class="co"># Exclusion features: excluding features with more than 10% missingness </span></span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a><span class="do">## Exclusion features: excluded 44 feature(s) </span></span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a><span class="co"># Exclusion samples: excluding samples with more than 10% missingness </span></span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a><span class="do">## Exclusion samples: excluded 15 sample(s) </span></span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a><span class="do">## Imputation using mean </span></span>
<span id="cb6-16"><a href="#cb6-16" tabindex="-1"></a><span class="co"># Outlier exclusion using PCA and LOF </span></span>
<span id="cb6-17"><a href="#cb6-17" tabindex="-1"></a><span class="do">## Excluded 1 sample(s)</span></span>
<span id="cb6-18"><a href="#cb6-18" tabindex="-1"></a><span class="do">## Creating sample outlier plot</span></span>
<span id="cb6-19"><a href="#cb6-19" tabindex="-1"></a><span class="do">### total feature(s) excluded = 44 </span></span>
<span id="cb6-20"><a href="#cb6-20" tabindex="-1"></a><span class="do">### total sample(s) excluded = 16 </span></span>
<span id="cb6-21"><a href="#cb6-21" tabindex="-1"></a><span class="co"># returning a list of data, outlier plot, and exclusion IDs</span></span></code></pre></div>
<div class="float">
<img src="outlier-example.png" alt="PCA + LOF outlier example"><div class="figcaption">PCA + LOF outlier example</div>
</div>
</div>
<div class="section level3">
<h3 id="plate-correction">Plate correction<a class="anchor" aria-label="anchor" href="#plate-correction"></a>
</h3>
<p>You can perform plate correction by providing sample and feature
meta-data files.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_processed</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/process_data.html">process_data</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data_features</span>, </span>
<span>  data_meta_samples <span class="op">=</span> <span class="va">data_meta_samples</span>,</span>
<span>  col_samples <span class="op">=</span> <span class="st">"ID_sample"</span>, </span>
<span>  data_meta_features <span class="op">=</span> <span class="va">data_meta_features</span>,</span>
<span>  col_features <span class="op">=</span> <span class="st">"ID_feature"</span>,</span>
<span>  plate_correction <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>  cols_listRandom <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"batch"</span><span class="op">)</span>, </span>
<span>  cols_listFixedToKeep <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"age"</span><span class="op">)</span>, </span>
<span>  cols_listFixedToRemove <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sex"</span><span class="op">)</span>, </span>
<span>  col_HeteroSked <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="other">Other<a class="anchor" aria-label="anchor" href="#other"></a>
</h3>
<p>Centering and scaling can be performed using
<code>centre_scale = TRUE</code>. Centering and scaling is performed for
log based transformations at the point of the transformation, regardless
of if <code>centre_scale = TRUE</code>.</p>
<p>If you are processing case-control data then you will likely want to
ensure excluded samples have their matched samples also excluded. This
can be done using <code>case_control = TRUE</code> and providing the
column name in <code>data_meta_samples</code> which has the matching
factor, <code>col_case_control = case_control_match</code>.</p>
<p>The processed data, the IDs for excluded samples and features and the
reasons for exclusions, and the outlier plot can be saved using
<code>save = TRUE</code> and providing a file path for the processed
data (<code>path_out = path/to/directory/</code>) and the exclusion data
(<code>path_outliers = path/to/directory/exclusions/</code>)</p>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<ol style="list-style-type: decimal">
<li>Application of linear mixed models to remove unwanted variability
(e.g., batch) and preserve biological variations while accounting for
potential differences in the residual variances across studies (Viallon
et al., 2021). The functions implementing this
(<code><a href="../reference/normalization_residualMixedModels.html">normalization_residualMixedModels()</a></code> and
<code><a href="../reference/FUNnormalization_residualMixedModels.html">FUNnormalization_residualMixedModels()</a></code>) utilise the R
packages <a href="https://github.com/JoeRothwell/pcpr2" class="external-link"><code>{pcpr2}</code></a>, <a href="https://github.com/lme4/lme4" class="external-link"><code>{lme4}</code></a>, and <a href="https://cran.r-project.org/web/packages/nlme/index.html" class="external-link"><code>{nlme}</code></a>
<ul>
<li>Viallon V, His M, Rinaldi S, et al. A New Pipeline for the
Normalization and Pooling of Metabolomics Data. Metabolites.
2021;11(9):631. Published 2021 Sep 17. <a href="https://pmc.ncbi.nlm.nih.gov/articles/PMC8467830/" class="external-link">doi:10.3390/metabo11090631</a>.</li>
<li>
<code>{PCPR2}</code>: Fages &amp; Ferrari et al. (2014)
Investigating sources of variability in metabolomic data in the EPIC
study: the Principal Component Partial R-square (PC-PR2) method.
Metabolomics 10(6): 1074-1083, <a href="https://link.springer.com/article/10.1007/s11306-014-0647-9" class="external-link">doi:
10.1007/s11306-014-0647-9</a>
</li>
<li>
<a href="https://github.com/lme4/lme4/" class="external-link">lme4</a>: Bates, D., Mächler, M., Bolker, B., &amp;
Walker, S. (2015). Fitting Linear Mixed-Effects Models Using lme4.
Journal of Statistical Software, 67(1), 1–48. <a href="https://www.jstatsoft.org/article/view/v067i01" class="external-link">doi.org/10.18637/jss.v067.i01</a>.</li>
<li>
<a href="https://svn.r-project.org/R-packages/trunk/nlme/" class="external-link">nlme</a>: Pinheiro, J. C. &amp; Bates, D. M.
Mixed-Effects Models in S and S-PLUS. (Springer, New York, 2000). <a href="https://link.springer.com/book/10.1007/b98882" class="external-link">doi:10.1007/b98882</a>
</li>
</ul>
</li>
<li>Sample exclusion performed using principal component analyses and a
local outlier factor (Breuing et al., 2000) using a Tukey rule (Tueky,
1977) modified to account for skewness and multiple testing (Hubert and
Vandervieren, 2008)
<ul>
<li>Markus M. Breunig, Hans-Peter Kriegel, Raymond T. Ng, and Jörg
Sander. 2000. LOF: identifying density-based local outliers. SIGMOD Rec.
29, 2 (June 2000), 93–104. <a href="https://dl.acm.org/doi/10.1145/335191.335388" class="external-link">doi.org/10.1145/335191.335388</a>
</li>
<li>Tukey, J. W. Exploratory Data Analysis. (Addison-Wesley Publishing
Company, 1977).</li>
<li>Hubert, M. and Vandervieren, E., (2008), An adjusted boxplot for
skewed distributions, Computational Statistics &amp; Data Analysis, 52,
issue 12, p. 5186-5201, <a href="https://EconPapers.repec.org/RePEc:eee:csdana:v:52:y:2008:i:12:p:5186-5201" class="external-link">EconPapers.repec.org/RePEc:eee:csdana:v:52:y:2008:i:12:p:5186-5201</a>.</li>
</ul>
</li>
<li>The implementation of sample exclusions is from the R package <a href="https://github.com/privefl/bigutilsr" class="external-link"><code>{bigutilsr}</code></a>
and is described in detail by Florian Privé in <a href="https://privefl.github.io/blog/detecting-outlier-samples-in-pca/" class="external-link">this
blog post</a>
</li>
</ol>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Vivian Viallon, Lee Matthew, Ali Farnudi.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
